<style>
  div.dt-buttons {
    float: left;
  }
  div.dataTables_length {
    float: left;
    margin-left: 50px;
  }
  div.dataTables_filter {
    float: right;
  }
</style>
<div class="tab-pane fade show active" id="tab-database" role="tabpanel">
  <div class="row" id="loginPanel">
    <div class="col-12 text-center">
      <button class="btn btn-primary" onclick="showLoginPopup()">Login</button>
      to access the server.
    </div>
  </div>
  <div class="row" id="databasePanel" style="display: none;">
    <div class="col-1">
      <label for="inputDatabase">Database</label>
    </div>
    <div class="col-3">
      <select id="inputDatabase"></select>
      <button class="btn btn-pill" onclick="createDatabase()">+ Create</button>
      <button class="btn btn-pill" onclick="dropDatabase()">- Drop</button>
      <button class="btn btn-pill" onclick="importDatabase()">&lt; Import</button>
    </div>
    <div class="col-4">
      &nbsp;
    </div>
    <div class="col-1">
      <label for="inputLanguage">Language</label>
    </div>
    <div class="col-3">
      <select id="inputLanguage">
        <option value="sql">SQL</option>
        <option value="gremlin">Apache Gremlin</option>
        <option value="cypher">Neo4j Cypher (Open Cypher)</option>
        <option value="mongodb">MongoDB</option>
      </select>
    </div>

    <div class="col-1">
      <label for="inputCommand">Command
        <br><br>
        <button class="btn btn-primary" onclick="executeCommand(true)">Execute
          <img id="executeSpinner" class="ui-loading" src="/images/color-spin-small.svg" style="display: none;">
        </button>
      </label>
    </div>
    <div class="col-11">
      <textarea id="inputCommand"
                style="width: 100%; height: 100px;">MATCH {type: Users, as: user}.out("rated"){as: rated} RETURN user, rated LIMIT 30</textarea>
    </div>

    <div class="col-12">
      <div class="row">
        <div class="col-6">
          <ul class="nav nav-tabs" id="tabs-command">
            <li class="nav-item"><a data-toggle="tab" href="#tab-table" class="active nav-link" id="tab-table-sel">&nbsp;Table</a></li>
            <li class="nav-item"><a data-toggle="tab" href="#tab-graph" class="nav-link" id="tab-graph-sel">&nbsp;Graph</a></li>
            <li class="nav-item"><a data-toggle="tab" href="#tab-json" class="nav-link" id="tab-json-sel">&nbsp;Json</a></li>
          </ul>
        </div>
        <div class="col-6">
          <div class="col-12 text-right">
            <label>Result <span id="result-num"></span>&nbsp;records, </label>
            <label>Time <span id="result-elapsed"></span>ms</label>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12">
      <div class="tab-content">
        <div class="tab-pane fade show active" id="tab-table" role="tabpanel">
          <table id="result" class="table table-striped table-sm" style="width: 100%"></table>
        </div>

        <div class="tab-pane fade" id="tab-graph" role="tabpanel">
          <nav class="navbar navbar-expand-lg navbar-light">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                  <span id="customToolbar"></span>
                </li>
              </ul>
              <ul class="navbar-nav">
                <li class="nav-item">
                  <a class="nav-link" href="#" onclick="renderGraph()"><i class="fa fa-sync"></i> Refresh</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#" onclick="exportGraph()"><i class="fa fa-download"></i> Export .graphml</a>
                </li>
                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                     aria-expanded="false">
                    <i class="fa fa-sliders-h"></i> Settings
                  </a>
                  <div class="dropdown-menu" aria-labelledby="navbarDropdown">

                    <a class="dropdown-item w-150" href="#">
                      <label for="edgeLength">Edge Length</label>
                      <input type="range" class="custom-range" min="50" max="300" step="50" id="edgeLength" value="100">
                    </a>

                  </div>
                </li>
              </ul>
              <form class="form-inline my-2 my-lg-0">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
              </form>
            </div>
          </nav>

          <div id="graph" style="height: 800px; width: 100%;"></div>
        </div>

        <div class="tab-pane fade" id="tab-json" role="tabpanel">
          <textarea id="resultJson" style="width: 100%; height: 600px;" disabled></textarea>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
  executeCommand(false);
});

$("#edgeLength").change( function(){
  globalGraphEdgeLength = $("#edgeLength").val();
  renderGraph();
});
</script>
